# OFFICE
ifconfig eth0 172.16.0.2/24

# STAFFNET
ifconfig eth1 10.1.0.1/21

# VOLNET
ifconfig eth2 10.2.0.1/21

# RESNET
ifconfig eth3 10.3.0.1/24

# IDMZNET
ifconfig eth4 10.4.0.1/24

route add default gw 172.16.0.1

iptables -t nat -A POSTROUTING -s 10.1.0.0/21 -j SNAT --to 172.16.0.2 -d 172.17.0.0/24


# FILTERS
# Block everything by default (whitelisting)
iptables -P FORWARD DROP


# Allow commlink between Enterprise Zone and Internal DMZ
# Staff network
iptables -A FORWARD -i eth1 -o eth4 -s 10.1.0.0/21 -d 10.4.0.0/24 -j ACCEPT
iptables -A FORWARD -i eth4 -o eth1 -s 10.4.0.0/24 -d 10.1.0.0/21 -j ACCEPT
# Volunteer network
iptables -A FORWARD -i eth2 -o eth4 -s 10.2.0.0/21 -d 10.4.0.0/24 -j ACCEPT
iptables -A FORWARD -i eth4 -o eth2 -s 10.4.0.0/24 -d 10.2.0.0/21 -j ACCEPT


# Allow commlink between Extranet Zone and Internal DMZ
iptables -A FORWARD -i eth0 -o eth4 -s 172.18.0.0/24 -d 10.4.0.0/24 -j ACCEPT
iptables -A FORWARD -i eth4 -o eth0 -s 10.4.0.0/24 -d 172.18.0.0/24 -j ACCEPT


# Allow commlink between Restricted Zone and Internal DMZ
iptables -A FORWARD -i eth3 -o eth4 -s 10.3.0.0/24 -d 10.4.0.0/24 -j ACCEPT
iptables -A FORWARD -i eth4 -o eth3 -s 10.4.0.0/24 -d 10.3.0.0/24 -j ACCEPT


# Allow commlink between Enterprise Zone and External DMZ
# Staff network
iptables -A FORWARD -i eth1 -o eth0 -s 10.1.0.0/21 -d 172.17.0.0/24 -j ACCEPT
iptables -A FORWARD -i eth0 -o eth1 -s 172.17.0.0/24 -d 10.1.0.0/21 -j ACCEPT
# Volunteer network
iptables -A FORWARD -i eth2 -o eth0 -s 10.2.0.0/21 -d 172.17.0.0/24 -j ACCEPT
iptables -A FORWARD -i eth0 -o eth2 -s 172.17.0.0/24 -d 10.2.0.0/21 -j ACCEPT


# Allow commlink between Enterprise Zone and Extranet Zone
# Staff network
iptables -A FORWARD -i eth1 -o eth0 -s 10.1.0.0/21 -d 172.18.0.0/24 -j ACCEPT
iptables -A FORWARD -i eth0 -o eth1 -s 172.18.0.0/24 -d 10.1.0.0/21 -j ACCEPT
# Volunteer network
iptables -A FORWARD -i eth2 -o eth0 -s 10.2.0.0/21 -d 172.18.0.0/24 -j ACCEPT
iptables -A FORWARD -i eth0 -o eth2 -s 172.18.0.0/24 -d 10.2.0.0/21 -j ACCEPT


# Allow commlink between Management Zone and all other zones behind Core-Router
#
# Allow commlink between Management Zone and Internal DMZ
iptables -A FORWARD -i eth0 -o eth4 -s 172.19.0.0/24 -d 10.4.0.0/24 -j ACCEPT
iptables -A FORWARD -i eth4 -o eth0 -s 10.4.0.0/24 -d 172.19.0.0/24 -j ACCEPT

# Allow commlink between Management Zone and Enterprise Zone
# Staff network
iptables -A FORWARD -i eth0 -o eth1 -s 172.19.0.0/24 -d 10.1.0.0/21 -j ACCEPT
iptables -A FORWARD -i eth1 -o eth0 -s 10.1.0.0/21 -d 172.19.0.0/24 -j ACCEPT
# Volunteer network
iptables -A FORWARD -i eth0 -o eth2 -s 172.19.0.0/24 -d 10.2.0.0/21 -j ACCEPT
iptables -A FORWARD -i eth2 -o eth0 -s 10.2.0.0/21 -d 172.19.0.0/24 -j ACCEPT

# Allow commlink between Management Zone and Restricted Zone
iptables -A FORWARD -i eth0 -o eth3 -s 172.19.0.0/24 -d 10.3.0.0/24 -j ACCEPT
iptables -A FORWARD -i eth3 -o eth0 -s 10.3.0.0/24 -d 172.19.0.0/24 -j ACCEPT
